import{j as e}from"./ui-libs-D97X_MCv.js";import{r as t}from"./react-vendor-Bmnvhqav.js";import{b as r,u as s,a as n,Q as o,P as a,k as i,j as l}from"./index-NpkEVbwN.js";import"./supabase-X-pkD9a7.js";import"./pdf-utils-CIzaveRM.js";import"./data-libs-DQyM0wFE.js";const d=({questions:d,onBack:c,isResuming:x=!1,initialQuizData:m=null})=>{const[u,b]=t.useState(0),[g,h]=t.useState({}),[f,p]=t.useState(!1),[y,w]=t.useState(null),[k,v]=t.useState(new Set),[j,N]=t.useState(!1),[q,C]=t.useState(!1),[S,A]=t.useState(0),[z,E]=t.useState(Date.now()),[Q,I]=t.useState(!1),[T,R]=t.useState(!1),[O,_]=t.useState(!1),[D,M]=t.useState(!1),[F,$]=t.useState({show:!1,points:0,action:""}),[B,L]=t.useState(!1),[H,U]=t.useState({}),W=t.useRef(null),P=t.useRef({}),V=t.useRef(0),Y=t.useRef(new Set),G=t.useRef(0),K=t.useRef(!1),X=t.useRef(!1),Z=t.useRef(!1),J=t.useRef(!1),ee=t.useRef({});t.useEffect(()=>{W.current=y},[y]),t.useEffect(()=>{P.current=g},[g]),t.useEffect(()=>{V.current=u},[u]),t.useEffect(()=>{Y.current=k},[k]),t.useEffect(()=>{G.current=S},[S]),t.useEffect(()=>{K.current=f},[f]),t.useEffect(()=>{X.current=T},[T]),t.useEffect(()=>{Z.current=D},[D]),t.useEffect(()=>{J.current=B},[B]),t.useEffect(()=>{ee.current=H},[H]);const{user:te}=r(),{quizManager:re,allQuizzesLoading:se}=s(),{data:ne,upsertData:oe}=n(),ae=async(e,t={})=>{if(te?.id)try{const r=await l(te.id,e,t);r.success&&0!==r.pointsAwarded&&$({show:!0,points:r.pointsAwarded,action:e})}catch(r){}},ie=()=>{$({show:!1,points:0,action:""})};t.useEffect(()=>{if(x&&m){const e=m.timeSpent||0,t=Date.now();E(t-1e3*e),A(e)}else{const e=Date.now();E(e),A(0)}},[x,m]),t.useEffect(()=>{if(!y)return;const e=`satlog:quiz:${y.id}:startTime`,t=localStorage.getItem(e);if(t){const e=parseInt(t,10);if(!isNaN(e)){E(e);const t=Date.now();A(Math.floor((t-e)/1e3))}}},[y]),t.useEffect(()=>{y&&z&&localStorage.setItem(`satlog:quiz:${y.id}:startTime`,String(z))},[y,z]),t.useEffect(()=>{if(f)return;const e=setInterval(()=>{const e=Date.now(),t=Math.floor((e-z)/1e3);A(t),w(e=>e?{...e,timeSpent:t}:e)},1e3);return()=>clearInterval(e)},[z,f]),t.useEffect(()=>()=>{const e=W.current,t=P.current,r=V.current,s=Y.current,n=G.current,a=K.current,i=X.current,l=e?.status===o.COMPLETED;if(e&&e.questions&&!a&&!i&&!l&&(Object.keys(t).length>0||n>0)){const o={...e,userAnswers:t,currentQuestionIndex:r,flaggedQuestions:Array.from(s),eliminationMode:J.current,eliminatedOptions:ee.current,lastUpdated:(new Date).toISOString(),timeSpent:n};re.saveQuiz(o).catch(e=>{}),e?.id&&localStorage.removeItem(`satlog:quiz:${e.id}:startTime`)}},[]);const le=e=>{const t=e%60;return`${Math.floor(e/60).toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`},de=e=>!e.passageText&&e.questionText&&e.questionText.length>200?{...e,passageText:e.questionText,questionText:"Which choice completes the text with the most logical and precise word or phrase?",options:e.options||Object.values(e.answerChoices||{}),correctAnswer:e.answerChoices?e.answerChoices[e.correctAnswer]:e.correctAnswer}:e.answerChoices&&!e.options?{...e,options:Object.values(e.answerChoices),correctAnswer:e.answerChoices[e.correctAnswer]||e.correctAnswer}:e;t.useEffect(()=>{_(!1),M(!1)},[d,x,m]),t.useEffect(()=>{if(O)return;if(x&&m)return w(m),h(m.userAnswers||{}),b(m.currentQuestionIndex||0),v(new Set(m.flaggedQuestions||[])),L(m.eliminationMode||!1),U(m.eliminatedOptions||{}),void _(!0);if(se||!re)return;if(!d||0===d.length)return void c();if(T||f)return;const e=d.map(de),t=re.createNewQuiz(e);w(t),_(!0)},[d,x,m,O,T,f,c,se,re]),t.useEffect(()=>{if(y&&Object.keys(g).length>0){const e=y.userAnswers||{};Object.keys(g).some(t=>g[t]!==e[t])&&M(!0)}},[g,y]);const ce=y?.questions?.[u],xe=async()=>{if(y&&y.questions&&!T){R(!0);try{const e=y.questions.map(e=>{const t=g[e.id]??e.userAnswer;let r=t;if(e.answerChoices&&t&&!["A","B","C","D"].includes(t))for(const[n,o]of Object.entries(e.answerChoices))if(o===t){r=n;break}const s=r===(e.answerChoices&&e.correctAnswer&&!["A","B","C","D"].includes(e.correctAnswer)&&Object.entries(e.answerChoices).find(([t,r])=>r===e.correctAnswer)?.[0]||e.correctAnswer);return{...e,userAnswer:r,isCorrect:s}});if(!re)throw new Error("QuizManager not available");const t=await re.finishQuiz(y,e,g,k,S);await ae("COMPLETE_QUIZ",{score:t.score}),t.score>=90&&(i(),setTimeout(()=>{ae("HIGH_SCORE_BONUS",{score:t.score})},1e3));const r={...ne||{}};e.forEach(e=>{e.userAnswer&&(r[e.id]||(r[e.id]=[]),r[e.id]=r[e.id].filter(e=>e.quizId!==t.id),r[e.id].push({quizId:t.id,answer:e.userAnswer,isCorrect:e.isCorrect,date:t.date}))}),await oe(r),localStorage.removeItem("satlog:resumeQuizId"),w(t),W.current=t,setTimeout(()=>{c()},500)}catch(e){alert("There was an error completing the quiz. Please try again."),c()}finally{R(!1)}}},me=e=>e<u?"blue":e===u?"yellow":"gray";return t.useEffect(()=>{const e=e=>{const t=W.current,r=P.current,s=G.current,n=K.current,o=X.current;if(t&&t.questions&&!n&&!o&&(Object.keys(r).length>0||s>0)){V.current,Array.from(Y.current),J.current,ee.current,(new Date).toISOString();return e.preventDefault(),e.returnValue="You have unsaved quiz progress. Are you sure you want to leave?",e.returnValue}};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}},[]),y&&y.questions&&ce?f?e.jsx("div",{className:"flex items-center justify-center p-4 h-screen",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-2xl w-full",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Almost Done!"}),e.jsx("p",{className:"text-gray-600",children:"Here's how you performed"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{className:"text-center p-6 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"text-4xl font-bold text-blue-600 mb-2",children:[y.score,"%"]}),e.jsx("div",{className:"text-gray-600 font-medium",children:"Overall Score"})]}),e.jsxs("div",{className:"text-center p-6 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-4xl font-bold text-green-600 mb-2",children:y.correctAnswers}),e.jsx("div",{className:"text-gray-600 font-medium",children:"Correct Answers"})]}),e.jsxs("div",{className:"text-center p-6 bg-red-50 rounded-lg",children:[e.jsx("div",{className:"text-4xl font-bold text-red-600 mb-2",children:y.totalQuestions-y.correctAnswers}),e.jsx("div",{className:"text-gray-600 font-medium",children:"Incorrect Answers"})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Quiz Summary"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Questions:"}),e.jsx("span",{className:"font-medium ml-2",children:y.totalQuestions})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Time Spent:"}),e.jsx("span",{className:"font-medium ml-2",children:le(S)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Flagged for Review:"}),e.jsx("span",{className:"font-medium ml-2",children:k.size})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Completion:"}),e.jsxs("span",{className:"font-medium ml-2",children:[Math.round((y.totalQuestions-y.correctAnswers)/y.totalQuestions*100),"%"]})]})]})]}),e.jsxs("div",{className:"flex justify-center space-x-4",children:[e.jsx("button",{onClick:()=>{p(!1),I(!0)},className:"bg-gray-200 text-gray-700 px-6 py-3 rounded-lg font-medium hover:bg-gray-300 transition-colors",children:"Back to Review"}),e.jsx("button",{onClick:xe,disabled:T,className:"px-6 py-3 rounded-lg font-medium transition-colors "+(T?"bg-gray-400 text-gray-600 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:T?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Finishing..."})]}):"Finish Quiz"})]})]})}):Q?e.jsxs("div",{className:"bg-gray-100 dark:bg-gray-900 flex flex-col h-screen overflow-hidden transition-colors duration-300",children:[e.jsx("header",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 p-3 sm:p-4 flex-shrink-0 relative transition-colors duration-300",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3 sm:gap-0",children:[e.jsx("div",{className:"flex items-center sm:flex-1",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-base sm:text-lg font-semibold text-gray-900 dark:text-white transition-colors duration-300",children:["Quiz ",y?.quizNumber??"N/A"]}),e.jsxs("button",{className:"text-xs sm:text-sm text-blue-600 dark:text-blue-400 hover:underline flex items-center transition-colors duration-300",children:["Directions ",e.jsx("span",{className:"material-icons text-sm",children:"arrow_drop_down"})]})]})}),e.jsx("div",{className:"absolute top-3 right-3 sm:relative sm:top-auto sm:right-auto sm:flex-1 sm:flex sm:justify-center text-center",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-lg sm:text-2xl font-bold text-gray-900 dark:text-white transition-opacity duration-300 "+(q?"opacity-0":"opacity-100"),children:le(S)}),e.jsx("button",{onClick:()=>C(!q),className:"text-xs bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-2 py-1 rounded hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors duration-300",children:q?"Show":"Hide"})]})}),e.jsxs("div",{className:"hidden sm:flex items-center space-x-4 sm:flex-1 sm:justify-end",children:[e.jsxs("button",{className:"text-sm text-gray-700 dark:text-gray-300 hover:text-black dark:hover:text-white flex items-center transition-colors duration-300",children:[e.jsx("span",{className:"material-icons mr-1",children:"edit"})," Annotate"]}),e.jsxs("button",{className:"text-sm text-gray-700 dark:text-gray-300 hover:text-black dark:hover:text-white flex items-center transition-colors duration-300",children:[e.jsx("span",{className:"material-icons mr-1",children:"more_vert"})," More"]})]})]})}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden bg-white dark:bg-gray-800 transition-colors duration-300",children:[e.jsxs("div",{className:"text-center py-4 sm:py-6 px-3 sm:px-0",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-800 dark:text-white mb-2 transition-colors duration-300",children:"Check Your Work"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-xs sm:text-sm mb-1 transition-colors duration-300",children:"On test day, you won't be able to move on to the next module until time expires."}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 text-xs sm:text-sm mb-4 sm:mb-6 transition-colors duration-300",children:["For these practice questions, you can click ",e.jsx("strong",{children:"Next"})," when you're ready to move on."]}),e.jsx("div",{className:"w-full border-t border-gray-300 dark:border-gray-600 mb-4 sm:mb-6 transition-colors duration-300"})]}),e.jsx("div",{className:"flex-1 flex justify-center px-3 sm:px-6 lg:px-8 pb-4 sm:pb-6 lg:pb-8",children:e.jsxs("div",{className:"bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg p-3 sm:p-6 lg:p-8 w-full max-w-5xl transition-colors duration-300",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 sm:mb-6 gap-3",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 dark:text-white transition-colors duration-300",children:"Section 1: Reading and Writing Module 1"}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 sm:gap-6",children:[e.jsxs("div",{className:"flex items-center text-xs sm:text-sm text-gray-700 dark:text-gray-300 transition-colors duration-300",children:[e.jsx("span",{className:"w-3 h-3 border-2 border-dashed border-gray-400 dark:border-gray-500 mr-2 transition-colors duration-300"}),e.jsx("span",{children:"Unanswered"})]}),e.jsxs("div",{className:"flex items-center text-xs sm:text-sm text-gray-700 dark:text-gray-300 transition-colors duration-300",children:[e.jsx("span",{className:"material-icons text-base mr-1 text-red-500",children:"bookmark"}),e.jsx("span",{children:"For Review"})]}),B&&e.jsxs("div",{className:"flex items-center text-xs sm:text-sm text-gray-700 dark:text-gray-300 transition-colors duration-300",children:[e.jsx("span",{className:"material-icons text-base mr-1 text-red-500",children:"close"}),e.jsx("span",{children:"Eliminated"})]})]})]}),e.jsx("div",{className:"flex w-full mb-4 sm:mb-6",children:y.questions.map((t,r)=>e.jsx("div",{className:"h-2 flex-1 "+(r<u?"bg-blue-500":r===u?"bg-yellow-400":"bg-gray-300")},r))}),e.jsx("div",{className:"grid grid-cols-5 sm:grid-cols-8 lg:grid-cols-10 gap-2 sm:gap-3 mb-4 sm:mb-6 justify-items-center",children:y.questions.map((t,r)=>{const s=g[t.id],n=r===u,o=k.has(t.id),a=(H[t.id]||[]).length>0;return e.jsxs("div",{onClick:()=>{b(r),I(!1)},className:`relative p-1.5 sm:p-2 text-center rounded cursor-pointer border-2 transition-all w-10 h-10 sm:w-12 sm:h-12 flex items-center justify-center ${s?"bg-blue-500 border-blue-500 text-white":"border-dashed border-gray-400 dark:border-gray-500 text-blue-600 dark:text-blue-400 hover:bg-gray-50 dark:hover:bg-gray-600"} ${n?"ring-2 ring-black dark:ring-white":""}`,children:[e.jsx("span",{className:"font-medium text-xs sm:text-sm",children:r+1}),n&&e.jsx("span",{className:"material-icons absolute -top-5 sm:-top-6 left-1/2 transform -translate-x-1/2 text-black dark:text-white text-base sm:text-lg transition-colors duration-300",children:"location_on"}),o&&e.jsx("span",{className:"material-icons absolute top-0.5 sm:top-1 right-0.5 sm:right-1 text-red-500 text-xs",children:"flag"}),a&&e.jsx("span",{className:"absolute -top-1 -right-1 w-3 h-3 bg-gray-400 dark:bg-gray-600 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs",children:"✕"})})]},r)})})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 p-4 sm:p-6 flex flex-col sm:flex-row sm:justify-between sm:items-center flex-shrink-0 transition-colors duration-300 gap-4 sm:gap-0",children:[e.jsx("div",{className:"text-sm text-gray-700 dark:text-gray-300 transition-colors duration-300 text-center sm:text-left",children:"Ready to submit your quiz?"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-3 sm:gap-4",children:[e.jsx("button",{onClick:()=>I(!1),className:"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-6 py-3 rounded-lg text-sm font-medium hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors duration-300 w-full sm:w-auto",children:"Back to Questions"}),e.jsx("button",{onClick:xe,disabled:T,className:"px-8 py-3 rounded-lg text-sm font-medium transition-colors duration-300 shadow-lg hover:shadow-xl w-full sm:w-auto "+(T?"bg-gray-400 text-gray-600 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"),children:T?e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Finishing..."})]}):"Finish Quiz"})]})]}),e.jsx("div",{className:"flex w-full flex-shrink-0",children:y.questions.map((t,r)=>e.jsx("div",{className:`progress-bar-segment ${me(r)}`},r))}),F.show&&e.jsx(a,{pointsAwarded:F.points,actionType:F.action,onComplete:ie})]}):e.jsxs("div",{className:"bg-gray-100 dark:bg-gray-900 transition-colors duration-300 flex flex-col h-screen overflow-hidden pb-20 sm:pb-0",children:[e.jsx("style",{children:"\n        .progress-bar-segment {\n          height: 6px;\n          flex-grow: 1;\n        }\n        .progress-bar-segment.blue {\n          background-color: #3b82f6;\n        }\n        .progress-bar-segment.yellow {\n          background-color: #facc15;\n        }\n        .progress-bar-segment.gray {\n          background-color: #e5e7eb;\n        }\n        .question-option {\n          display: flex;\n          align-items: center;\n          padding: 0.75rem 1rem;\n          border: 1px solid #d1d5db;\n          border-radius: 0.375rem;\n          margin-bottom: 0.75rem;\n          cursor: pointer;\n          transition: all 0.2s ease-in-out;\n          color: #374151;\n        }\n        .dark .question-option {\n          border-color: #4b5563;\n          color: #d1d5db;\n        }\n        .question-option:hover {\n          background-color: #f3f4f6;\n          border-color: #9ca3af;\n        }\n        .dark .question-option:hover {\n          background-color: #374151;\n          border-color: #6b7280;\n        }\n        .question-option.selected {\n          background-color: #dbeafe;\n          border-color: #3b82f6;\n        }\n        .dark .question-option.selected {\n          background-color: #1e3a8a;\n          border-color: #3b82f6;\n        }\n        .question-option.selected:hover {\n          background-color: #bfdbfe;\n          border-color: #2563eb;\n        }\n        .dark .question-option.selected:hover {\n          background-color: #1e40af;\n          border-color: #2563eb;\n        }\n        \n        /* Eliminated option styles */\n        .question-option.eliminated {\n          opacity: 0.3;\n          pointer-events: none;\n          background-color: #f9fafb;\n          border-color: #e5e7eb;\n          position: relative;\n          overflow: visible !important;\n        }\n        .dark .question-option.eliminated {\n          opacity: 0.3;\n          pointer-events: none;\n          background-color: #374151;\n          border-color: #4b5563;\n          position: relative;\n          overflow: visible !important;\n        }\n        .question-option.eliminated::after {\n          content: '';\n          position: absolute;\n          top: 50%;\n          left: -20px !important;\n          right: -10px !important;\n          height: 2px;\n          background-color: #374151 !important;\n          transform: translateY(-50%);\n          z-index: 15 !important;\n          margin: 0 !important;\n          opacity: 1 !important;\n        }\n        .dark .question-option.eliminated::after {\n          background-color: #9ca3af !important;\n        }\n        .question-option.eliminated .option-letter {\n          background-color: #9ca3af;\n          color: #6b7280;\n          border-color: #9ca3af;\n        }\n        .dark .question-option.eliminated .option-letter {\n          background-color: #6b7280;\n          color: #9ca3af;\n          border-color: #6b7280;\n        }\n        .question-option.eliminated:hover {\n          background-color: #f9fafb;\n          border-color: #e5e7eb;\n          opacity: 0.3;\n        }\n        .dark .question-option.eliminated:hover {\n          background-color: #374151;\n          border-color: #4b5563;\n          opacity: 0.3;\n        }\n        \n        /* ABC button styles */\n        .btn-default.btn-line-black.undo-btn {\n          position: relative;\n          overflow: hidden;\n        }\n        .option-letter {\n          display: inline-flex;\n          align-items: center;\n          justify-content: center;\n          width: 1.75rem;\n          height: 1.75rem;\n          border-radius: 50%;\n          border: 1px solid #9ca3af;\n          margin-right: 0.75rem;\n          font-weight: 500;\n          transition: all 0.2s ease-in-out;\n          color: #374151;\n        }\n        .dark .option-letter {\n          border-color: #6b7280;\n          color: #d1d5db;\n        }\n        .question-option.selected .option-letter {\n          background-color: #3b82f6;\n          color: white;\n          border-color: #3b82f6;\n        }\n        /* Question box base styles - no hover effects */\n        .question-box {\n          border: 2px solid #e5e7eb;\n          cursor: pointer;\n          padding: 8px;\n          margin: 4px;\n          border-radius: 8px;\n          min-height: 36px;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          background-color: #f9fafb;\n          color: #374151;\n          font-weight: 500;\n          font-size: 14px;\n          position: relative;\n        }\n        .dark .question-box {\n          border-color: #4b5563;\n          background-color: #374151;\n          color: #d1d5db;\n        }\n        \n        /* DISABLE ALL HOVER/FOCUS/ACTIVE EFFECTS */\n        .question-box:hover,\n        .question-box:focus,\n        .question-box:active,\n        .question-box:focus-visible,\n        .question-box:focus-within {\n          border-color: #e5e7eb !important;\n          background-color: #f9fafb !important;\n          color: #374151 !important;\n          transform: none !important;\n          box-shadow: none !important;\n          outline: none !important;\n        }\n        .dark .question-box:hover,\n        .dark .question-box:focus,\n        .dark .question-box:active,\n        .dark .question-box:focus-visible,\n        .dark .question-box:focus-within {\n          border-color: #4b5563 !important;\n          background-color: #374151 !important;\n          color: #d1d5db !important;\n        }\n        \n        /* Current question indicator - only the arrow, same background */\n        .question-box.current {\n          /* Keep same colors as unanswered */\n          border-color: #e5e7eb;\n          background-color: #f9fafb;\n          color: #374151;\n        }\n        .dark .question-box.current {\n          border-color: #4b5563;\n          background-color: #374151;\n          color: #d1d5db;\n        }\n        .question-box.current::before {\n          content: \"\\e0c8\";\n          font-family: 'Material Icons';\n          position: absolute;\n          top: -24px;\n          left: 50%;\n          transform: translateX(-50%);\n          font-size: 24px;\n          color: #374151; /* Dark icon for light mode */\n        }\n        .dark .question-box.current::before {\n          color: #d1d5db; /* Light icon for dark mode */\n        }\n        .question-box.current:hover,\n        .question-box.current:focus,\n        .question-box.current:active,\n        .question-box.current:focus-visible {\n          border-color: #e5e7eb !important;\n          background-color: #f9fafb !important;\n          color: #374151 !important;\n        }\n        .dark .question-box.current:hover,\n        .dark .question-box.current:focus,\n        .dark .question-box.current:active,\n        .dark .question-box.current:focus-visible {\n          border-color: #4b5563 !important;\n          background-color: #374151 !important;\n          color: #d1d5db !important;\n        }\n        \n        /* Answered questions - blue background */\n        .question-box.answered {\n          background-color: #3b82f6;\n          border-color: #3b82f6;\n          color: white;\n        }\n        .dark .question-box.answered {\n          background-color: #2563eb;\n          border-color: #2563eb;\n          color: white;\n        }\n        .question-box.answered span {\n          color: white;\n        }\n        .question-box.answered:hover,\n        .question-box.answered:focus,\n        .question-box.answered:active,\n        .question-box.answered:focus-visible {\n          background-color: #3b82f6 !important;\n          border-color: #3b82f6 !important;\n          color: white !important;\n        }\n        .dark .question-box.answered:hover,\n        .dark .question-box.answered:focus,\n        .dark .question-box.answered:active,\n        .dark .question-box.answered:focus-visible {\n          background-color: #2563eb !important;\n          border-color: #2563eb !important;\n          color: white !important;\n        }\n        \n        /* Flagged questions - only add the flag, no background changes */\n        .question-box.flagged::after {\n          content: \"🚩\";\n          position: absolute;\n          top: 2px;\n          right: 2px;\n          font-size: 12px;\n          color: #ef4444;\n        }\n        \n        /* Make sure flagged unanswered questions keep their base colors */\n        .question-box.flagged:not(.answered):not(.current) {\n          border-color: #e5e7eb;\n          background-color: #f9fafb;\n          color: #374151;\n        }\n        .dark .question-box.flagged:not(.answered):not(.current) {\n          border-color: #4b5563;\n          background-color: #374151;\n          color: #d1d5db;\n        }\n        \n        /* Flagged + Answered combination - Higher specificity */\n        .question-box.answered.flagged {\n          background-color: #3b82f6 !important;\n          border-color: #3b82f6 !important;\n          color: white !important;\n        }\n        .dark .question-box.answered.flagged {\n          background-color: #2563eb !important;\n          border-color: #2563eb !important;\n          color: white !important;\n        }\n        .question-box.answered.flagged:hover,\n        .question-box.answered.flagged:focus,\n        .question-box.answered.flagged:active,\n        .question-box.answered.flagged:focus-visible {\n          background-color: #3b82f6 !important;\n          border-color: #3b82f6 !important;\n          color: white !important;\n        }\n        .dark .question-box.answered.flagged:hover,\n        .dark .question-box.answered.flagged:focus,\n        .dark .question-box.answered.flagged:active,\n        .dark .question-box.answered.flagged:focus-visible {\n          background-color: #2563eb !important;\n          border-color: #2563eb !important;\n          color: white !important;\n        }\n        \n        /* Flagged + Current combination - same as current, just adds flag */\n        .question-box.current.flagged {\n          border-color: #e5e7eb;\n          background-color: #f9fafb;\n          color: #374151;\n        }\n        .dark .question-box.current.flagged {\n          border-color: #4b5563;\n          background-color: #374151;\n          color: #d1d5db;\n        }\n        \n        /* Questions with eliminated options */\n        .question-box.has-eliminated {\n          border-color: #9ca3af;\n          background-color: #f3f4f6;\n        }\n        .dark .question-box.has-eliminated {\n          border-color: #6b7280;\n          background-color: #4b5563;\n        }\n        .question-box.has-eliminated:hover,\n        .question-box.has-eliminated:focus,\n        .question-box.has-eliminated:active,\n        .question-box.has-eliminated:focus-visible {\n          border-color: #9ca3af !important;\n          background-color: #f3f4f6 !important;\n        }\n        .dark .question-box.has-eliminated:hover,\n        .dark .question-box.has-eliminated:focus,\n        .dark .question-box.has-eliminated:active,\n        .dark .question-box.has-eliminated:focus-visible {\n          border-color: #6b7280 !important;\n          background-color: #4b5563 !important;\n        }\n      "}),e.jsx("header",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 p-3 sm:p-4 flex-shrink-0 relative transition-colors duration-300",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3 sm:gap-0",children:[e.jsx("div",{className:"flex items-center sm:flex-1",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-base sm:text-lg font-semibold text-gray-900 dark:text-white transition-colors duration-300",children:["Quiz ",y?.quizNumber??"N/A"]}),e.jsxs("button",{className:"text-xs sm:text-sm text-blue-600 dark:text-blue-400 hover:underline flex items-center transition-colors duration-300",children:["Directions ",e.jsx("span",{className:"material-icons text-sm",children:"arrow_drop_down"})]})]})}),e.jsx("div",{className:"absolute top-3 right-3 sm:relative sm:top-auto sm:right-auto sm:flex-1 sm:flex sm:justify-center text-center",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-lg sm:text-2xl font-bold text-gray-900 dark:text-white transition-opacity duration-300 "+(q?"opacity-0":"opacity-100"),children:le(S)}),e.jsx("button",{onClick:()=>C(!q),className:"text-xs bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-2 py-1 rounded hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors duration-300",children:q?"Show":"Hide"})]})}),e.jsxs("div",{className:"hidden sm:flex items-center space-x-4 sm:flex-1 sm:justify-end",children:[e.jsxs("button",{className:"text-sm text-gray-700 dark:text-gray-300 hover:text-black dark:hover:text-white flex items-center transition-colors duration-300",children:[e.jsx("span",{className:"material-icons mr-1",children:"edit"})," Annotate"]}),e.jsxs("button",{className:"text-sm text-gray-700 dark:text-gray-300 hover:text-black dark:hover:text-white flex items-center transition-colors duration-300",children:[e.jsx("span",{className:"material-icons mr-1",children:"more_vert"})," More"]})]})]})}),e.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden min-h-0",children:[e.jsxs("div",{className:"w-full md:w-1/2 p-3 sm:p-4 overflow-y-auto bg-white dark:bg-gray-800 border-b md:border-b-0 md:border-r border-gray-200 dark:border-gray-700 transition-colors duration-300 flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3 sm:mb-4 flex-shrink-0",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 transition-colors duration-300",children:" "}),e.jsx("button",{className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-colors duration-300 hidden sm:block",children:e.jsx("span",{className:"material-icons",children:"fullscreen"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[ce.passageImage&&e.jsx("img",{src:ce.passageImage,alt:"Passage",className:"max-h-60 sm:max-h-80 rounded shadow border mb-2 mx-auto w-full object-contain"}),ce.passageText&&e.jsx("p",{className:"text-sm sm:text-base text-gray-700 dark:text-gray-300 transition-colors duration-300 leading-relaxed",children:ce.passageText}),!ce.passageText&&!ce.passageImage&&e.jsx("p",{className:"text-sm sm:text-base text-gray-700 dark:text-gray-300 transition-colors duration-300 leading-relaxed",children:ce.questionText})]})]}),e.jsxs("div",{className:"w-full md:w-1/2 p-3 sm:p-4 overflow-y-auto bg-white dark:bg-gray-800 transition-colors duration-300 flex flex-col",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-3 sm:mb-4 flex-shrink-0 gap-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"bg-black dark:bg-gray-700 text-white text-xs sm:text-sm font-semibold px-2 py-1 rounded-sm mr-2 transition-colors duration-300",children:u+1}),e.jsxs("button",{onClick:()=>{ce&&v(e=>{const t=new Set(e);return t.has(ce.id)?t.delete(ce.id):t.add(ce.id),t})},className:"text-xs sm:text-sm text-gray-700 dark:text-gray-300 hover:text-black dark:hover:text-white flex items-center transition-colors duration-300",children:[e.jsx("span",{className:"material-icons text-base sm:text-lg mr-1 "+(k.has(ce.id)?"text-red-500":""),children:k.has(ce.id)?"bookmark":"bookmark_border"}),e.jsx("span",{className:k.has(ce.id)?"text-red-500":"",children:"Mark for Review"})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("button",{onClick:()=>{L(e=>!e)},className:"btn-default btn-line-black undo-btn text-xs sm:text-sm font-medium px-3 py-1 rounded-full border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 flex items-center justify-center relative",style:{minWidth:"38px",minHeight:"26px",height:"26px",padding:"0 10px"},children:[e.jsx("span",{style:{position:"relative",zIndex:1},children:"ABC"}),e.jsx("svg",{width:"100%",height:"100%",viewBox:"0 0 38 26",style:{position:"absolute",left:0,top:0,width:"100%",height:"100%",pointerEvents:"none",zIndex:2},children:e.jsx("line",{x1:"2",y1:"24",x2:"36",y2:"2",stroke:"#333",strokeWidth:"2",strokeLinecap:"round"})})]})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[e.jsx("p",{className:"text-sm sm:text-base text-gray-700 dark:text-gray-300 mb-3 sm:mb-4 transition-colors duration-300",children:ce.passageText?ce.questionText:"Which choice completes the text with the most logical and precise word or phrase?"}),e.jsx("div",{className:"space-y-2 sm:space-y-3",style:{overflow:"visible"},children:(ce.options||Object.values(ce.answerChoices||{})).map((t,r)=>{const s=String.fromCharCode(65+r),n=g[ce.id]===t,o=B&&H[ce.id]?.includes(t);return e.jsxs("div",{className:"flex items-center space-x-3",style:{overflow:"visible"},children:[e.jsxs("div",{onClick:()=>(e=>{if(!ce)return;const t=e===ce.correctAnswer;h(t=>({...t,[ce.id]:e})),w(r=>({...r,questions:r.questions.map((r,s)=>s===u?{...r,userAnswer:e,isCorrect:t}:r)}))})(t),className:`question-option min-w-0 ${n?"selected":""} ${o?"eliminated":""}`,style:{padding:"0.5rem 0.75rem",width:B?"calc(100% - 80px)":"100%",display:"flex",alignItems:"center"},children:[e.jsx("span",{className:"option-letter",style:{width:"1.5rem",height:"1.5rem",marginRight:"0.5rem",flexShrink:0},children:s}),e.jsx("span",{className:"text-sm sm:text-base",style:{flex:1,minWidth:0},children:t})]}),B&&e.jsx("button",{onClick:()=>(e=>{if(!ce)return;const t=ce.id,r=H[t]||[];U(s=>({...s,[t]:r.includes(e)?r.filter(t=>t!==e):[...r,e]}))})(t),className:"elimination-btn rounded-full border-2 flex items-center justify-center text-xs font-bold transition-all duration-200 flex-shrink-0 "+(o?"bg-gray-400 border-gray-400 text-white px-2 py-1":"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-600 w-6 h-6"),children:o?"undo":s})]},r)})})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 p-3 sm:p-4 flex flex-col sm:flex-row sm:justify-between sm:items-center flex-shrink-0 transition-colors duration-300 relative gap-3 sm:gap-0",children:[e.jsxs("div",{className:"text-xs sm:text-sm text-gray-700 dark:text-gray-300 transition-colors duration-300 text-center sm:text-left sm:flex-1",children:["Welcome, ",(()=>{if(!te)return"User";if(te.user_metadata?.name)return te.user_metadata.name;if(te.email){return te.email.split("@")[0].replace(/[._]/g," ").split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}return"User"})()]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-3 sm:gap-0 sm:space-x-2 relative sm:flex-1 sm:justify-center",children:[e.jsxs("button",{onClick:()=>N(!j),className:"bg-black dark:bg-gray-700 text-white px-3 sm:px-4 py-2 rounded-md text-xs sm:text-sm font-medium hover:bg-gray-800 dark:hover:bg-gray-600 transition-colors duration-300 w-full sm:w-auto",children:["Question ",u+1," of ",y.questions.length,e.jsx("span",{className:"material-icons text-sm align-middle",children:"arrow_drop_down"})]}),j&&e.jsx("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 z-50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 sm:p-6 rounded-lg shadow-xl w-[300px] sm:w-[420px] border border-gray-200 dark:border-gray-700 max-h-96 overflow-y-auto transition-colors duration-300",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 sm:mb-6",children:[e.jsxs("h1",{className:"text-base sm:text-lg font-semibold text-gray-800 dark:text-white transition-colors duration-300",children:["Quiz ",y?.quizNumber??"N/A"]}),e.jsx("button",{onClick:()=>N(!1),className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-colors duration-300",children:e.jsx("span",{className:"material-icons",children:"close"})})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 sm:gap-4 mb-4 sm:mb-6 pb-4 border-b border-gray-300 dark:border-gray-600 transition-colors duration-300 text-xs",children:[e.jsxs("div",{className:"flex items-center text-gray-700 dark:text-gray-300 transition-colors duration-300",children:[e.jsx("span",{className:"material-icons text-base mr-2 text-blue-600",children:"location_on"}),e.jsx("span",{children:"Current"})]}),e.jsxs("div",{className:"flex items-center text-gray-700 dark:text-gray-300 transition-colors duration-300",children:[e.jsx("span",{className:"material-icons text-base mr-2 text-gray-400",children:"check_box_outline_blank"}),e.jsx("span",{children:"Unanswered"})]}),e.jsxs("div",{className:"flex items-center text-gray-700 dark:text-gray-300 transition-colors duration-300",children:[e.jsx("span",{className:"material-icons text-base mr-2 text-red-500",children:"bookmark"}),e.jsx("span",{children:"For Review"})]})]}),e.jsx("div",{className:"grid grid-cols-6 sm:grid-cols-8 gap-1 mb-4 sm:mb-6 p-2",children:y.questions.map((t,r)=>{const s=g[t.id],n=r===u,o=k.has(t.id);return e.jsx("div",{onClick:()=>(e=>{b(e),N(!1)})(r),className:`question-box cursor-pointer ${n?"current":""} ${s?"answered":""} ${o?"flagged":""}`,style:{transition:"none",minHeight:"32px",fontSize:"12px"},children:e.jsx("span",{className:"font-medium text-xs "+(s?"text-white dark:text-gray-800":n?"text-white":"text-gray-600 dark:text-gray-300"),children:r+1})},r)})}),e.jsx("button",{onClick:()=>{N(!1),I(!0)},className:"w-full py-2 px-3 bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 border border-blue-600 dark:border-blue-400 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 transition duration-150 ease-in-out text-xs sm:text-sm",children:"Go to Review Page"})]})})]}),e.jsxs("div",{className:"flex items-center space-x-2 w-full sm:w-auto sm:flex-1 sm:justify-end",children:[e.jsx("button",{onClick:()=>b(Math.max(0,u-1)),disabled:0===u,className:"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-3 sm:px-4 py-2 rounded-md text-xs sm:text-sm font-medium hover:bg-gray-300 dark:hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-300 flex-1 sm:flex-initial",children:"Back"}),e.jsx("button",{onClick:()=>{u===y.questions.length-1?I(!0):b(u+1)},className:"bg-blue-600 text-white px-3 sm:px-4 py-2 rounded-md text-xs sm:text-sm font-medium hover:bg-blue-700 transition-colors duration-300 flex-1 sm:flex-initial",children:"Next"})]})]}),e.jsx("div",{className:"flex w-full flex-shrink-0",children:y.questions.map((t,r)=>e.jsx("div",{className:`progress-bar-segment ${me(r)}`},r))}),F.show&&e.jsx(a,{pointsAwarded:F.points,actionType:F.action,onComplete:ie})]}):e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading quiz..."})})};export{d as default};
